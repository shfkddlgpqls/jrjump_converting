# 🏫 Academy Analysis Guide (소스 분석 가이드)

이 문서는 Academy 도메인의 원본 PHP 소스 코드를 분석하기 위한 가이드입니다.
구현을 시작하기 전, 본 가이드에 따라 레거시 코드를 분석하여 비즈니스 로직을 정확히 파악해야 합니다.

---

## 1. 분석 프로세스 (Process)

### 1.1. 분할 분석 전략 (Divide & Conquer) - **중요**
- **절대 한 번에 모든 파일을 읽지 마십시오.**
- `MIGRATION_MAP.md`의 "기능(Feature)" 단위로 **하나씩(One by One)** 분석 세션을 가져야 합니다.
- **View 로직 스킵**: HTML 태그가 많은 부분은 과감히 생략(Skip)하고, `<?php ... ?>` 블록 위주로 분석하십시오.

### 1.2. 엔트리 포인트 확인
- `MIGRATION_MAP.md`에 명시된 타겟 **PHP 파일**을 엽니다.
- 해당 파일이 독립적으로 실행되는지, 아니면 `include` 되어 실행되는지 파악합니다.
- 주요 파라미터(`$_GET`, `$_POST`)가 무엇인지 식별합니다.

### 1.3. 쿼리 추출 (SQL Extraction)
- 파일 내에서 `SELECT`, `INSERT`, `UPDATE`, `DELETE` 구문을 모두 찾습니다.
- **동적 쿼리** 조합 로직(예: `if($cond) $query .= " AND ... "`)을 주의 깊게 살핍니다.
- 사용된 테이블명과 컬럼명이 `ENTITY_GUIDE.md`와 일치하는지 대조합니다.

### 1.4. 비즈니스 로직 식별
- **데이터 가공**: DB에서 가져온 데이터를 PHP 단에서 반복문(`foreach`, `while`)으로 가공하는 로직을 찾습니다.
- **분기 처리**: 특정 조건(`if`, `switch`)에 따라 비즈니스 흐름이 바뀌는 부분을 찾습니다.
- **화면 로직 제외**: 단순 HTML 출력(`echo "<tr>...</tr>"`)이나 스타일 관련 코드는 분석 대상에서 제외(또는 참고만)합니다.

---

## 2. 핵심 정책 발굴 (Core Policy Discovery) - **Mandatory**
단순 코드 변환을 넘어, **기획자가 의도한 비즈니스 규칙(Business Rule)**을 찾아내야 합니다.
코드를 "해석"하지 말고, 그 뒤에 숨은 "의도"를 파악하십시오.

- **운영/제약 정책**: "과거 날짜 접근 시 왜 막는가?", "특정 시즌이 자동으로 열리는 기준은 무엇인가?"
- **연동 정책**: "왜 타 사이트(인강) DB를 참조하는가? 데이터의 원천(Source of Truth)은 어디인가?"
- **노출 정책**: "모든 데이터가 다 나오는가? 아니면 특정 플래그(`main_status`)에 따라 숨겨지는가?"

> **Action**: 발견된 정책은 **반드시** `agent_docs/academy/POLICY.md` 파일을 생성하여 기록하십시오. (보고 전 필수 산출물)

---

## 3. 중점 체크리스트 (Check Points)

### ✅ 인코딩 (Encoding)
- `iconv()`, `mb_convert_encoding()` 함수 사용 여부를 확인합니다.
- 한글 문자열이 하드코딩된 경우(`echo "안녕하세요"`) 인코딩 상태를 의심해봐야 합니다.

### ✅ 하드코딩 (Hard-coding)
- 특정 ID나 코드값(`if ($id == 'hackers')`)이 하드코딩되어 있는지 찾습니다.
- 이러한 하드코딩은 `agent_docs/common/ENUM_GUIDE.md` 정책에 따라 `Enum`으로 변환해야 합니다.

### ✅ 외부 의존성 (Dependency)
- `require_once`, `include` 된 파일 중 로직에 영향을 주는 공통 파일(`class_Academy.php` 등)을 함께 분석해야 합니다.

### ✅ 데이터 정합성 (Data Consistency)
- 코지만 보지 말고 실제 DB 데이터를 `LIMIT 10`으로 조회하여 샘플링합니다.
- `NULL`, `0000-00-00` 날짜, 예상을 벗어난 값 등이 있는지 확인하여 예외 처리에 반영합니다.

---

## 4. 분석 결과물 (Output)
분석이 끝나면 다음과 같은 정보를 머릿속에 정리(또는 메모)해야 합니다.
- [ ] 이 기능의 **핵심 SQL**은 무엇인가?
- [ ] 이 기능의 **필수 입력 파라미터**는 무엇인가?
- [ ] **주의해야 할 예외 조건**(로그인 여부, 기간 만료 등)은 무엇인가?
- [ ] **발견된 숨겨진 정책**은 무엇인가?
